---
title: "PII leakage"
description: "Sensitive data that ended up in logs"
icon: "shield-exclamation"
iconType: "duotone"
---

Credit card numbers, emails, SSNs, API keys. Sensitive data that ended up in logs. A developer logs a request object. An error message includes user data. A third-party library dumps more than expected.

## Example

<Tabs>
  <Tab title="Credit card numbers">
    <Tabs>
      <Tab title="Before">
        ```json
        {
          "@timestamp": "2024-01-15T10:30:00Z",
          "service.name": "payment-service",
          "event": "payment.processed",
          "card_number": "4111111111111111",
          "amount": 99.99
        }
        ```
      </Tab>
      <Tab title="After">
        ```json
        {
          "@timestamp": "2024-01-15T10:30:00Z",
          "service.name": "payment-service",
          "event": "payment.processed",
          "amount": 99.99
        }
        ```
      </Tab>
    </Tabs>

    ```yaml
    id: redact-credit-card-payment-service
    name: Redact credit card numbers from payment-service
    description: Remove card_number field containing credit card data.
    log:
      match:
        - resource_attribute: service.name
          exact: payment-service
        - log_attribute: card_number
          regex: "^[0-9]{13,19}$"
      transform:
        remove:
          - log_attribute: card_number
    ```
  </Tab>
  <Tab title="Email addresses">
    <Tabs>
      <Tab title="Before">
        ```json
        {
          "@timestamp": "2024-01-15T10:30:00Z",
          "service.name": "user-service",
          "event": "user.updated",
          "user_id": "usr_abc123",
          "email": "alice@example.com"
        }
        ```
      </Tab>
      <Tab title="After">
        ```json
        {
          "@timestamp": "2024-01-15T10:30:00Z",
          "service.name": "user-service",
          "event": "user.updated",
          "user_id": "usr_abc123"
        }
        ```
      </Tab>
    </Tabs>

    ```yaml
    id: redact-email-user-service
    name: Redact email addresses from user-service
    description: Remove email field containing user email addresses.
    log:
      match:
        - resource_attribute: service.name
          exact: user-service
        - log_attribute: email
          exists: true
      transform:
        remove:
          - log_attribute: email
    ```
  </Tab>
  <Tab title="API keys in messages">
    <Tabs>
      <Tab title="Before">
        ```json
        {
          "@timestamp": "2024-01-15T10:30:00Z",
          "service.name": "integration-service",
          "body": "Request failed with key sk_live_abc123xyz789..."
        }
        ```
      </Tab>
      <Tab title="After">
        ```json
        {
          "@timestamp": "2024-01-15T10:30:00Z",
          "service.name": "integration-service",
          "body": "Request failed with key [REDACTED]"
        }
        ```
      </Tab>
    </Tabs>

    ```yaml
    id: redact-api-key-integration-service
    name: Redact API keys from integration-service logs
    description: Redact Stripe API keys found in log messages.
    log:
      match:
        - resource_attribute: service.name
          exact: integration-service
        - log_field: body
          regex: "sk_live_[a-zA-Z0-9]+"
      transform:
        redact:
          - log_field: body
            pattern: "sk_live_[a-zA-Z0-9]+"
            replacement: "[REDACTED]"
    ```
  </Tab>
</Tabs>

Each PII pattern gets its own policy. You approve them individually based on your compliance requirements.

## Recommended enforcement

<CardGroup cols={2}>
  <Card title="Enforce at edge" icon="server" href="/policies/enforcement/edge">
    Redact PII before data leaves your network. It never reaches your provider.
  </Card>
  <Card title="Open PRs" icon="code-pull-request" href="/policies/enforcement/open-prs">
    Fix the instrumentation so PII is never logged in the first place.
  </Card>
</CardGroup>

Edge enforcement is critical. Redacting at the edge means sensitive data never leaves your infrastructure. No cleanup required. No breach notifications. The blast radius is zero.

But also fix the source. Open a PR to remove sensitive fields from the log statement entirely.

## How it works

PII detection is hard when you don't know what you're scanning. A 16-digit number might be a credit card or a database ID. A string matching an email regex might be a test fixture. Without context, you need Luhn checksums, lookahead patterns, entity recognition, confidence scoring — techniques to disambiguate what you found.

Tero has context. The [Master Catalog](/master-catalog) contains every log event and attribute — what each field represents, what values it contains, why it exists. So Tero knows which fields to scan.

Any field that could contain PII through normal developer error gets scanned: `error_message`, `request_body`, `user_input`, free-form text fields. The only fields skipped are structurally incompatible with PII — `timestamp`, `severity`, `status_code`, `pid`. These fields have fixed formats. PII can't end up there through a logging mistake.

Tero detects PII using patterns from [gitleaks](https://github.com/gitleaks/gitleaks), a widely-used open source project for secret detection.

<AccordionGroup>
  <Accordion title="Personal information">
    - Credit card numbers (Visa, Mastercard, Amex, Discover)
    - Social Security numbers (US)
    - National Insurance numbers (UK)
    - Email addresses
    - Phone numbers
    - IP addresses
    - IBANs
  </Accordion>
  
  <Accordion title="Cloud providers">
    - AWS access keys and secret keys
    - GCP API keys
    - Azure AD client secrets
    - Alibaba access keys
    - DigitalOcean tokens
    - Heroku API keys
    - Cloudflare API keys
    - Databricks API tokens
  </Accordion>
  
  <Accordion title="Source control & CI/CD">
    - GitHub tokens (PAT, OAuth, App, Fine-grained)
    - GitLab tokens (PAT, Deploy, Runner, CI/CD job)
    - Bitbucket client secrets
    - Travis CI tokens
    - CircleCI tokens
    - Drone CI tokens
  </Accordion>
  
  <Accordion title="Communication & collaboration">
    - Slack tokens (bot, user, webhook)
    - Discord tokens
    - Telegram bot tokens
    - Microsoft Teams webhooks
    - Mattermost tokens
    - Twilio API keys
  </Accordion>
  
  <Accordion title="Databases & infrastructure">
    - Database connection strings
    - Planetscale tokens
    - MongoDB connection strings
    - Redis connection strings
    - Elasticsearch credentials
  </Accordion>
  
  <Accordion title="Payment & financial">
    - Stripe API keys
    - Square access tokens
    - Plaid API tokens
    - Coinbase access tokens
    - GoCardless tokens
  </Accordion>
  
  <Accordion title="AI & ML services">
    - OpenAI API keys
    - Anthropic API keys
    - Hugging Face tokens
    - Cohere API tokens
  </Accordion>
  
  <Accordion title="Observability & monitoring">
    - Datadog access tokens
    - New Relic API keys
    - Grafana API keys
    - Sentry tokens
    - Dynatrace API tokens
  </Accordion>
  
  <Accordion title="SaaS & productivity">
    - Notion API tokens
    - Asana client secrets
    - Linear API keys
    - Jira API tokens
    - Shopify access tokens
    - SendGrid API tokens
    - Mailchimp API keys
  </Accordion>
  
  <Accordion title="Cryptographic material">
    - Private keys (RSA, DSA, EC, PGP)
    - JWTs
    - PKCS12 files
    - Age secret keys
  </Accordion>
</AccordionGroup>
